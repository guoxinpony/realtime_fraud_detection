mlflow:
  experiment_name: "fraud_detection"
  registered_model_name: "fraud_detection_default"
  tracking_uri: "http://mlflow-server:5500"
  artifact_location: "s3://mlflow/fraud_detection"
  s3_endpoint_url: "http://minio:9000"
  bucket: "mlflow"

kafka:
  bootstrap_servers: "kafka_broker:9092"
  # username: "FWNDEFYYI5D4RII2"
  # password: "cfltk4VkQCqAu/toxD5DYuapfzkth71nFFNADK+taynZkdrZRDgZ/2oiwM8WZcog"
  topic: "ml_model_train"
  test_data: "fraud_test_data"
  output_topic: "fraud_predictions"
  security_protocol: 'PLAINTEXT'
  timeout: 12000
  max_messages: 50000

data:
  training_csv: "./data/fraud_detection_data.csv"

models:
  xgboost:
    test_size: 0.2
    validation_size: 0.1
    n_folds: 10
    early_stopping_rounds: 25
    threshold_recall_target: 0.9
    seed: 666
    use_feature_selection: true  # Enable feature selection
    feature_selection_threshold: 0.01  # Keep features with importance >= threshold
    max_features: 10  # Maximum number of features to keep
    params:
      n_estimators: 50  # Further reduced - simpler model
      learning_rate: 0.03  # Further reduced - slower learning
      max_depth: 2  # Very shallow trees to prevent overfitting
      subsample: 0.6  # More aggressive row sampling
      colsample_bytree: 0.6  # More aggressive column sampling
      colsample_bylevel: 0.6  # Additional column sampling per level
      min_child_weight: 10  # Much stronger constraint
      reg_alpha: 5.0  # Strong L1 regularization
      reg_lambda: 5.0  # Strong L2 regularization
      gamma: 1.0  # Higher minimum loss reduction
      tree_method: "hist"
      scale_pos_weight: 10
    path: "/app/models/fraud_detection_model_xgboost.pkl"
    test_path: "/app/models/fraud_detection_model_TEST.pkl"
    mlflow_registered_model_name: "fraud_detection_xgboost"
  logistic:
    test_size: 0.2
    validation_size: 0.1
    n_folds: 10
    threshold_recall_target: 0.9
    negative_downsample_ratio: 0.4
    seed: 666
    params:
      solver: "lbfgs"
      max_iter: 1000
      class_weight: "balanced"
      C: 1.0
    path: "/app/models/fraud_detection_model_logistic.pkl"
    test_path: "/app/models/fraud_detection_model_logistic_TEST.pkl"
    mlflow_registered_model_name: "fraud_detection_logistic"
  catboost:
    test_size: 0.2
    validation_size: 0.1
    n_folds: 10
    early_stopping_rounds: 25
    threshold_recall_target: 0.9
    seed: 666
    use_feature_selection: true  # Enable feature selection
    feature_selection_threshold: 0.01  # Keep features with importance >= threshold
    max_features: 10  # Maximum number of features to keep
    params:
      iterations: 50  # Further reduced - simpler model
      learning_rate: 0.03  # Further reduced - slower learning
      depth: 3  # Very shallow trees to prevent overfitting
      l2_leaf_reg: 20  # Much stronger L2 regularization
      loss_function: "Logloss"
      eval_metric: "PRAUC"
      task_type: "CPU"
      subsample: 0.6  # More aggressive row sampling
      random_strength: 2.0  # More randomness to scoring
      min_data_in_leaf: 10  # Much higher minimum samples in leaf
      rsm: 0.6  # Random subspace method - feature sampling
    path: "/app/models/fraud_detection_model_catboost.pkl"
    test_path: "/app/models/fraud_detection_model_catboost_TEST.pkl"
    mlflow_registered_model_name: "fraud_detection_catboost"
  random_forest:
    test_size: 0.2
    seed: 666
    params:
      n_estimators: 300
      max_depth: null
      min_samples_split: 2
      min_samples_leaf: 1
      max_features: "sqrt"
    path: "/app/models/fraud_detection_model_random_forest.pkl"
    mlflow_registered_model_name: "fraud_detection_random_forest"
  lightgbm:
    test_size: 0.2
    seed: 666
    max_messages: 5000
    params:
      n_estimators: 300
      learning_rate: 0.05
      num_leaves: 31
      max_depth: -1
      subsample: 0.8
      colsample_bytree: 0.8
    path: "/app/models/fraud_detection_model_lightgbm.pkl"
    mlflow_registered_model_name: "fraud_detection_lightgbm"
  tabnet:
    test_size: 0.2
    seed: 666
    params:
      learning_rate: 0.05
      max_iter: 200
      max_leaf_nodes: 31
      max_depth: null
      min_samples_leaf: 20
      l2_regularization: 0.0
      early_stopping: true
    path: "/app/models/fraud_detection_model_tabnet.pkl"
    mlflow_registered_model_name: "fraud_detection_tabnet"
  decision_tree:
    test_size: 0.2
    seed: 666
    params:
      criterion: "gini"
      splitter: "best"
      max_depth: 10
      min_samples_split: 2
      min_samples_leaf: 1
      class_weight: "balanced"
      random_state: 666
    path: "/app/models/fraud_detection_model_decision_tree.pkl"
    mlflow_registered_model_name: "fraud_detection_decision_tree"
  extra_tree:
    test_size: 0.2
    seed: 666
    params:
      n_estimators: 100
      criterion: "gini"
      max_depth: 15
      min_samples_split: 2
      min_samples_leaf: 1
      max_features: "sqrt"
      bootstrap: false
      class_weight: "balanced"
      random_state: 666
      n_jobs: -1
    path: "/app/models/fraud_detection_model_extra_tree.pkl"
    mlflow_registered_model_name: "fraud_detection_extra_tree"
  mlp:
    seed: 666
    params:
      hidden_layer_sizes: [256, 128ï¼Œ 64]
      activation: "relu"
      solver: "adam"
      alpha: 0.0003
      learning_rate: "adaptive"
      learning_rate_init: 0.0008
      max_iter: 150
      batch_size: 256
      early_stopping: true
      n_iter_no_change: 12
      tol: 0.0002
      random_state: 666
    path: "/app/models/fraud_detection_model_mlp.pkl"
    mlflow_registered_model_name: "fraud_detection_mlp"




spark:
  app_name: "FraudDetectionInference"
  packages: "org.mlflow:mlflow-spark:2.6.0,com.google.guava:guava:30.1.1-jre,org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.4,org.apache.hadoop:hadoop-aws:3.3.0,com.amazonaws:aws-java-sdk:1.11.469"
  shuffle_partition: 200
  checkpoint_location: 'checkpoints'
